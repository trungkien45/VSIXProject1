Rough code, but it gets the job done.
